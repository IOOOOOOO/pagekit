!function(e){var t={};function s(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=2)}([function(e,t){e.exports=UIkit.util},function(e,t){e.exports=UIkit},function(e,t,s){"use strict";s.r(t);var a=s(1),i=s.n(a),n=s(0);let l;i.a.component("autocomplete",{props:{minLength:Number,delay:Number,loadingClass:String,flipDropdown:Boolean,skipClass:String,hoverClass:String,source:null,renderer:null,template:String},data:{minLength:3,param:"search",method:"post",delay:300,loadingClass:"uk-loading",flipDropdown:!1,skipClass:"uk-skip",hoverClass:"uk-active",source:null,renderer:null,template:'<ul class="uk-nav uk-nav-autocomplete uk-autocomplete-results">{{~items}}<li data-value="{{$item.value}}"><a>{{$item.value}}</a></li>{{/items}}</ul>',visible:!1,value:null,selected:null},created(){this.template=this.rtemplate(this.template),this.dropdown=Object(n.$)('<div class="uk-dropdown"></div>'),Object(n.attr)(this.dropdown,"aria-expanded","false")},connected(){const e=this;this.isSelect=!1,this.trigger=this.debounce(function(t){if(this.isSelect)return this.isSelect=!1;e.handle()},this.delay),Object(n.on)(document,"click",e=>{l&&e.target!=l.input[0]&&l.hide()}),Object(n.append)(this.$el,this.dropdown),Object(n.attr)(Object(n.find)("input",this.$el),"autocomplete","off"),this.input=Object(n.find)("input",this.$el),this.triggercomplete=this.trigger},events:[{name:"keydown",delegate:()=>"input",handler(e){if(e&&e.which&&!e.shiftKey&&this.visible)switch(e.which){case 13:this.isSelect=!0,this.selected&&(e.preventDefault(),this.select());break;case 38:e.preventDefault(),this.pick("prev",!0);break;case 40:e.preventDefault(),this.pick("next",!0);break;case 27:case 9:this.hide()}}},{name:"keyup",delegate:()=>"input",handler(e){this.trigger(e)}},{name:"click",delegate:()=>".uk-autocomplete-results > *",handler(e){this.select()}},{name:"mouseover",delegate:()=>".uk-autocomplete-results > *",handler(e){"li"==e.target.parentNode.tagName.toLowerCase()&&this.pick(Object(n.$)(e.target.parentNode))}}],methods:{handle(){const e=this,t=this.value;return this.value=this.input.value,this.value.length<this.minLength?this.hide():(this.value!=t&&e.request(),this)},debounce(e,t,s){let a;return function(){const i=this,n=arguments,l=s&&!a;clearTimeout(a),a=setTimeout(function(){a=null,s||e.apply(i,n)},t),l&&e.apply(i,n)}},pick(e,t){const s=this,a=Object(n.findAll)(`>:not(.${this.skipClass})`,Object(n.find)(".uk-autocomplete-results",Object(n.$)(this.dropdown)));let l=!1;if("string"==typeof e||Object(n.hasClass)(Object(n.$)(e),this.skipClass)){if("next"==e||"prev"==e){if(this.selected){const t=Object(n.getIndex)(this.selected,a);l="next"==e?Object(n.toNodes)(a)[t+1<a.length?t+1:0]:Object(n.toNodes)(a)[t-1<0?a.length-1:t-1]}else l=this.selected?a[Object(n.getIndex)("next"==e?"next":"previous",a)]:a[0];l=Object(n.$)(l)}}else l=e;if(l&&(this.selected=l,a.forEach(e=>{Object(n.removeClass)(e,s.hoverClass)}),Object(n.addClass)(Object(n.$)(this.selected),this.hoverClass),t)){const{top:e}=l.getBoundingClientRect(),{scrollTop:t}=s.dropdown;(e>s.dropdown.offsetHeight||e<0)&&i.a.util.scrollTop(s.dropdown,t+e)}},select(){if(!this.selected)return;const e=Object.assign({},this.selected.dataset);Object(n.trigger)(this.$el,"select",[this,e]),e.value&&(this.input.value=e.value,Object(n.trigger)(this.input,"change")),this.hide()},show(){if(!this.visible)return this.visible=!0,Object(n.addClass)(Object(n.$)(this.dropdown),"uk-open"),l&&l!==this&&l.hide(),l=this,Object(n.attr)(Object(n.$)(this.dropdown),"aria-expanded","true"),this},hide(){if(this.visible)return this.visible=!1,Object(n.removeClass)(Object(n.$)(this.dropdown),"uk-open"),l===this&&(l=!1),Object(n.attr)(Object(n.$)(this.dropdown),"aria-expanded","false"),this},request(){const e=this,t=function(t){t&&e.render(t),Object(n.removeClass)(e.$el,e.loadingClass)};if(Object(n.addClass)(this.$el,this.loadingClass),this.source){const{source:a}=this;switch(typeof this.source){case"function":this.source.apply(this,[t]);break;case"object":if(a.length){const s=[];a.forEach(t=>{t.value&&-1!=t.value.toLowerCase().indexOf(e.value.toLowerCase())&&s.push(t)}),t(s)}break;case"string":var s={};s[this.param]=this.value,UI.$.ajax({url:this.source,data:s,type:this.method,dataType:"json"}).done(e=>{t(e||[])});break;default:t(null)}}else Object(n.removeClass)(this.$el,e.loadingClass)},render(e){return Object(n.empty)(Object(n.$)(this.dropdown)),this.selected=!1,this.renderer?this.renderer.apply(this,[e]):e&&e.length&&(this.dropdown.append(this.template({items:e})),Object(n.append)(this.dropdown,this.template({items:e})),this.show(),this.trigger("show")),this},rtemplate(e,t){const s=e.replace(/\n/g,"\\n").replace(/\{\{\{\s*(.+?)\s*\}\}\}/g,"{{!$1}}").split(/(\{\{\s*(.+?)\s*\}\})/g);let a,i,n,l,r=0;const o=[];let c=0;for(;r<s.length;){if((a=s[r]).match(/\{\{\s*(.+?)\s*\}\}/))switch(i=(a=s[r+=1])[0],n=a.substring(a.match(/^(\^|\#|\!|\~|\:)/)?1:0),i){case"~":o.push(`for(var $i=0;$i<${n}.length;$i++) { var $item = ${n}[$i];`),c++;break;case":":o.push(`for(var $key in ${n}) { var $val = ${n}[$key];`),c++;break;case"#":o.push(`if(${n}) {`),c++;break;case"^":o.push(`if(!${n}) {`),c++;break;case"/":o.push("}"),c--;break;case"!":o.push(`__ret.push(${n});`);break;default:o.push(`__ret.push(escape(${n}));`)}else o.push(`__ret.push('${a.replace(/\'/g,"\\'")}');`);r+=1}return l=new Function("$data",["var __ret = [];","try {","with($data){",c?'__ret = ["Not all blocks are closed correctly."]':o.join(""),"};","}catch(e){__ret = [e.message];}",'return __ret.join("").replace(/\\n\\n/g, "\\n");',"function escape(html) { return String(html).replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');}"].join("\n")),t?l(t):l}}}),i.a.component("pagination",{props:{items:Number,itemsOnPage:Number,pages:Number,displayedPages:Number,edges:Number,currentPage:Number,lblPrev:Boolean,lblNext:Boolean,onSelectPage(){}},data:{items:1,itemsOnPage:1,pages:0,displayedPages:7,edges:1,currentPage:0,lblPrev:!1,lblNext:!1,onSelectPage(){}},connected(){this.pages=this.pages?this.pages:Math.ceil(this.items/this.itemsOnPage)?Math.ceil(this.items/this.itemsOnPage):1,this.currentPage=this.currentPage,this.halfDisplayed=this.displayedPages/2,this._render()},events:[{name:"click",delegate:()=>"a[data-page]",handler(e){e.preventDefault(),this.selectPage(Object(n.data)(e.target,"page"))}}],methods:{_getInterval(){return{start:Math.ceil(this.currentPage>this.halfDisplayed?Math.max(Math.min(this.currentPage-this.halfDisplayed,this.pages-this.displayedPages),0):0),end:Math.ceil(this.currentPage>this.halfDisplayed?Math.min(this.currentPage+this.halfDisplayed,this.pages):Math.min(this.displayedPages,this.pages))}},render(e){this.pages=e||this.pages,this._render()},selectPage(e,t){this.currentPage=e,this.render(t),this.onSelectPage.apply(this,[e]),Object(n.trigger)(this.$el,"select.uk.pagination",[this,e])},_render(){const e=this,t=this._getInterval();let s;if(Object(n.empty)(Object(n.$)(this.$el)),e.lblPrev&&this._append(this.currentPage-1,{text:e.lblPrev}),t.start>0&&e.edges>0){const a=Math.min(e.edges,t.start);for(s=0;s<a;s++)this._append(s);e.edges<t.start&&t.start-e.edges!=1?this.element.append("<li><span>...</span></li>"):t.start-e.edges==1&&this._append(e.edges)}for(s=t.start;s<t.end;s++)this._append(s);if(t.end<this.pages&&e.edges>0){for(this.pages-e.edges>t.end&&this.pages-e.edges-t.end!=1?this.element.append("<li><span>...</span></li>"):this.pages-e.edges-t.end==1&&this._append(t.end++),s=Math.max(this.pages-e.edges,t.end);s<this.pages;s++)this._append(s)}e.lblNext&&this._append(this.currentPage+1,{text:e.lblNext})},_append(e,t){let s,a;e=e<0?0:e<this.pages?e:this.pages-1,a=Object.assign({text:e+1},t),s=e==this.currentPage?`<li class="uk-active"><span>${a.text}</span></li>`:`<li><a href="#page-${e+1}" data-page="${e}">${a.text}</a></li>`,Object(n.append)(this.$el,s)}}});var r={name:"Menu",data(){return _.extend({nav:null,item:null,subnav:null,size:null,sb:this.$session.get("admin.sidebar",!1)},window.$pagekit)},beforeCreate(){},created(){const e=_(this.menu).sortBy("priority").groupBy("parent").value(),t=_.find(e.root,"active");this.nav=e.root,t&&(this.item=t,this.subnav=e[t.id]),this.size=this.sbSize(e),this.sb&&(Object(n.css)(Object(n.$)(".tm-body-wrapper"),"marginLeft",this.size),Object(n.addClass)(Object(n.$)("body"),"sidebar-expanded"))},mounted(){Object(n.removeClass)(Object(n.$)("body"),"preload")},methods:{toggleSidebar(){this.sb=!this.sb,this.setStyle(),this.$session.set("admin.sidebar",this.sb)},getChild(e,t){const s=_(this.menu).sortBy("priority").groupBy("parent").value();return t?!!s[e]:s[e]},style(e){let t={};return this.sb&&"sidebar"==e?t={width:this.size}:this.sb&&"sidebar"!=e&&(t={"margin-left":this.size}),t},setStyle(){const e=Object(n.$)("body"),t=Object(n.$)(".tm-body-wrapper");Object(n.hasClass)(t,"transition")||Object(n.addClass)(t,"transition"),this.sb?(Object(n.addClass)(e,"sidebar-expanded"),Object(n.css)(t,"margin-left",this.size)):(Object(n.removeClass)(e,"sidebar-expanded"),Object(n.css)(t,"margin-left",""))},sbSize(e){let t=0,s=Object.assign({},e.root);const a=Object(n.$)("#js-appnav>li>a>span"),i=Object(n.$)(".tm-toggle-sidebar"),l=Object(n.$)(".tm-toggle-sidebar>a>span"),r=[Object(n.css)(l,"font"),Object(n.css)(a,"font")],o=this.txtSize(l.textContent,r[0]);return(s=_.map(s,e=>this.txtSize(this.$trans(e.label),r[1]))).push(o),`${(t=Math.max.apply(null,s))+parseInt(Object(n.css)(i,"paddingLeft"))+parseInt(Object(n.css)(Object(n.$)("i",i),"width"))+parseInt(Object(n.css)(Object(n.$)("span",i),"marginLeft"))+35}px`},txtSize(e,t){const s=document.createElement("canvas").getContext("2d");return s.font=t,s.measureText(e).width}}};Vue.ready(()=>{(new(Vue.extend(r))).$mount("#sidebar"),Object(n.on)("#js-appnav","stop",function(e){const t={};Object(n.toNodes)(this.children).forEach((e,s)=>{t[e.getAttribute("data-id")]=s}),Vue.http.post("admin/adminmenu",{order:t})}),i.a.mixin({data:{timeout:1500}},"notification"),Object(n.toNodes)(Object(n.$)(".pk-system-messages").children).forEach(e=>{const t=e.dataset;t.status&&"success"==t.status&&(t.timeout=1500),i.a.notification(Object(n.html)(e),t),Object(n.remove)(e)}),i.a.modal.alert=function(e,t){return t=Object(n.assign)({bgClose:!1,escClose:!1,labels:i.a.modal.labels},t),new Promise(s=>Object(n.on)(i.a.modal.dialog(`${t.title?`<div class="uk-modal-header"><h2>${t.title}</h2></div>`:""}<div class="uk-modal-body">${Object(n.isString)(e)?e:Object(n.html)(e)}</div> <div class="uk-modal-footer uk-text-right"> <button class="uk-button uk-button-primary uk-modal-close" autofocus>${t.labels.Ok}</button> </div> `,t).$el,"hide",s))},i.a.modal.confirm=function(e,t){return t=Object(n.assign)({bgClose:!1,escClose:!0,labels:i.a.modal.labels},t),new Promise((s,a)=>{const l=i.a.modal.dialog(` <form>${t.title?`<div class="uk-modal-header"><h2>${t.title}</h2></div>`:""} <div class="uk-modal-body">${Object(n.isString)(e)?e:Object(n.html)(e)}</div> <div class="uk-modal-footer uk-text-right"> <button class="uk-button uk-button-secondary uk-modal-close" type="button">${t.labels.cancel}</button> <button class="uk-button uk-button-primary" autofocus>${t.labels.ok}</button> </div> </form> `,t);let r=!1;Object(n.on)(l.$el,"submit","form",e=>{e.preventDefault(),s(),r=!0,l.hide()}),Object(n.on)(l.$el,"hide",()=>{r||a()})})},i.a.modal.prompt=function(e,t,s,a){return a=Object(n.assign)({bgClose:!1,escClose:!0,labels:i.a.modal.labels},a),new Promise(l=>{const r=i.a.modal.dialog(` <form class="uk-form-stacked">${a.title?`<div class="uk-modal-header"><h2>${a.title}</h2></div>`:""} <div class="uk-modal-body"> <label>${Object(n.isString)(e)?e:Object(n.html)(e)}</label> <input class="uk-input" autofocus> </div> <div class="uk-modal-footer uk-text-right"> <button class="uk-button uk-button-secondary uk-modal-close" type="button">${a.labels.cancel}</button> <button class="uk-button uk-button-primary">${a.labels.ok}</button> </div> </form> `,a),o=Object(n.$)("input",r.$el);o.value=t;let c=!1;Object(n.on)(r.$el,"submit","form",e=>{e.preventDefault(),s(o.value),l(o.value),c=!0,r.hide()}),Object(n.on)(r.$el,"hide",()=>{c||l(null)})})},i.a.tooltip(".tm-toggle-sidebar button",{pos:"right",delay:200})})}]);